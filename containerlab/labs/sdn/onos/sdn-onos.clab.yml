# SDN Lab

name: sdn-onos

mgmt:
  network: statics
  ipv4-subnet: 172.100.100.0/24

topology:
  kinds:
    linux:
      image: networklessons/lab-node-ubuntu:270
  nodes:
    controller:
      kind: linux
      image: onosproject/onos:2.7-latest
      mgmt-ipv4: 172.100.100.10
      ports:
      - "8181:8181"  # REST API and GUI
      - "8101:8101"  # ONOS CLI
      - "9876:9876"  # intra-cluster communication
      - "6653:6653"  # OpenFlow
      - "6640:6640"  # OVSDB
      - "830:830"    # NETCONF
      - "5005:5005"  # debugging
    sdn-spine1:
      kind: ovs-bridge
    sdn-leaf1:
      kind: ovs-bridge
    sdn-leaf2:
      kind: ovs-bridge
    s1:
      kind: linux
      mgmt-ipv4: 172.100.100.51
      exec:
      - ip link set dev eth1 address 00:50:c2:53:40:01
      - ip addr add 172.16.12.1/24 dev eth1
    s2:
      kind: linux
      mgmt-ipv4: 172.100.100.52
      exec:
      - ip link set dev eth1 address 00:50:c2:53:50:01
      - ip addr add 172.16.12.2/24 dev eth1
  links:
    # Spine-to-Leaf links (controller-facing)
    - endpoints: ["sdn-spine1:onos-s1l1", "sdn-leaf1:onos-l1s1"]
    - endpoints: ["sdn-spine1:onos-s1l2", "sdn-leaf2:onos-l2s1"]
    # Leaf-to-Server links (access ports)
    - endpoints: ["sdn-leaf1:onos-l1h1", "s1:eth1"]
    - endpoints: ["sdn-leaf2:onos-l2h1", "s2:eth1"]
